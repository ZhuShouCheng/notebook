# SM4 算法原理及实现

## SM4算法原理

#### 算法结构

SM4密码算法是一个分组算法。该算法的分组长度为128比特，密钥长度为128比特。加密算法与密钥扩展算法都采用32轮非线性迭代结构。数据解密和数据加密的算法结构相同，只是轮密钥的使用顺序相反，解密轮密钥是加密轮密钥的逆序。

#### 加密算法

加密算法有32次迭代运算和1次反序变换R组成

![](pic\sm4加密算法.png)

#### 轮密钥

![](D:\笔记\notebook\公司\国标\pic\轮函数.png)

##### T合成置换

![](pic\T_1.png)

![](pic\T_2.png)

##### 密钥扩展算法

![](pic\密钥扩展.png)

#### 解密算法

解密变换和加密变换结构相同，不同的仅是轮密钥的使用顺序。解密时，使用轮密钥序与加密相反。