# SM3算法原理及实现

## SM3 算法原理

#### 概述

对于长度为l（l < 2**64）比特的消息m，SM3算法经过填充、迭代压缩和输出选裁，Hash值输出长度为256比特。

#### 填充

假设消息m的长度为l比特

1. 首先将比特1添加到消息的末尾
2. 再添加k个0，k满足l+1+k=448(mod 512)的最小非负整数
3. 再添加一个64位比特串，该比特串是长度l的二进制标识。

填充后的消息比特长度为512的倍数

#### 迭代压缩



##### 迭代过程

![](pic\迭代过程.png)

##### 消息扩展

![](pic\消息扩展.png)

##### 压缩函数

![](pic\压缩函数.png)

#### 杂凑值

256比特的杂凑值y=ABCDEFGH



## SM3 算法实现

